name: Push Notification
on:
  push:
    branches: [main]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Push Notification
        env:
          WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK }}
          COMMIT_MSG: ${{ github.event.head_commit.message }}
          COMMIT_URL: ${{ github.event.head_commit.url }}
          PUSHER: ${{ github.event.head_commit.author.username }}
          REPO_NAME: ${{ github.repository }}
        run: |
          EMOJI="ðŸš€"
          COLOR="10181046"
          MSG=$(echo "$COMMIT_MSG" | head -1)
          curl -H "Content-Type: application/json" \
            -d "{\"embeds\":[{\"title\":\"${EMOJI} Push to main: ${MSG}\",\"url\":\"${COMMIT_URL}\",\"color\":${COLOR},\"fields\":[{\"name\":\"Repo\",\"value\":\"${REPO_NAME}\",\"inline\":true},{\"name\":\"Author\",\"value\":\"${PUSHER}\",\"inline\":true}]}]}" \
            "$WEBHOOK_URL"
